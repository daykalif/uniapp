{"version":3,"file":"dtPicker.js","sources":["components/dtPicker/dtPicker.vue","/Users/daykalif/Desktop/project/components/dtPicker/dtPicker.vue?type=component"],"sourcesContent":["<template>\n\t<view>\n\t\t<picker mode=\"multiSelector\" @change=\"doChange\" @columnchange=\"doColumnChange\" :value=\"self_value\" :range=\"self_range\">\n\t\t\t<input :disabled=\"true\" placeholder-style=\"color:#bbbbbb\" :placeholder=\"placeholder\" :value=\"value_text\" />\n\t\t</picker>\n\t</view>\n</template>\n\n<script setup>\n\timport {\n\t\tref,\n\t\treactive,\n\t\tonBeforeMount,\n\t\tdefineProps,\n\t\tdefineEmits,\n\t\ttoRaw,\n\t\twatch\n\t} from 'vue'\n\tconst props = defineProps({\n\t\ttimestamp: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\temptyText: {\n\t\t\ttype: String,\n\t\t\tdefault: ''\n\t\t},\n\t\tplaceholder: {\n\t\t\ttype: String,\n\t\t\tdefault: ''\n\t\t}\n\t})\n\tconst emit = defineEmits(['dtPickerChanged'])\n\t// 当前时间\n\tconst now = new Date().getTime()\n\tconst self_range = ref([])\n\tlet self_days = null\n\tlet self_days_text = ''\n\tlet self_hours = null\n\tlet self_seconds = null\n\tconst self_value = ref([0, 0, 0])\n\tconst value_text = ref()\n\tonBeforeMount(() => {\n\t\tconst days = ['']\n\t\tconst days_text = [props.emptyText]\n\t\tfor (let i = 0; i < 20; i++) {\n\t\t\tdays.push(TIME_FORMAT(now + 86400000 * i, 'YYYY-MM-dd'));\n\t\t\tlet text = TIME_FORMAT(now + 86400000 * i, 'M月d日');\n\t\t\tif (i == 0) {\n\t\t\t\ttext += ' （今天）';\n\t\t\t}\n\t\t\tif (i == 1) {\n\t\t\t\ttext += ' （明天）';\n\t\t\t}\n\t\t\tif (i == 2) {\n\t\t\t\ttext += ' （后天）';\n\t\t\t}\n\t\t\tdays_text.push(text);\n\t\t\tconst hours = ['00', '01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12', '13', '14',\n\t\t\t\t'15', '16', '17', '18', '19', '20', '21', '22', '23'\n\t\t\t];\n\t\t\tconst seconds = [\n\t\t\t\t'00',\n\t\t\t\t'01',\n\t\t\t\t'02',\n\t\t\t\t'03',\n\t\t\t\t'04',\n\t\t\t\t'05',\n\t\t\t\t'06',\n\t\t\t\t'07',\n\t\t\t\t'08',\n\t\t\t\t'09',\n\t\t\t\t'10',\n\t\t\t\t'11',\n\t\t\t\t'12',\n\t\t\t\t'13',\n\t\t\t\t'14',\n\t\t\t\t'15',\n\t\t\t\t'16',\n\t\t\t\t'17',\n\t\t\t\t'18',\n\t\t\t\t'19',\n\t\t\t\t'20',\n\t\t\t\t'21',\n\t\t\t\t'22',\n\t\t\t\t'23',\n\t\t\t\t'24',\n\t\t\t\t'25',\n\t\t\t\t'26',\n\t\t\t\t'27',\n\t\t\t\t'28',\n\t\t\t\t'29',\n\t\t\t\t'30',\n\t\t\t\t'31',\n\t\t\t\t'32',\n\t\t\t\t'33',\n\t\t\t\t'34',\n\t\t\t\t'35',\n\t\t\t\t'36',\n\t\t\t\t'37',\n\t\t\t\t'38',\n\t\t\t\t'39',\n\t\t\t\t'40',\n\t\t\t\t'41',\n\t\t\t\t'42',\n\t\t\t\t'43',\n\t\t\t\t'44',\n\t\t\t\t'45',\n\t\t\t\t'46',\n\t\t\t\t'47',\n\t\t\t\t'48',\n\t\t\t\t'49',\n\t\t\t\t'50',\n\t\t\t\t'51',\n\t\t\t\t'52',\n\t\t\t\t'53',\n\t\t\t\t'54',\n\t\t\t\t'55',\n\t\t\t\t'56',\n\t\t\t\t'57',\n\t\t\t\t'58',\n\t\t\t\t'59'\n\t\t\t];\n\t\t\tconst range = [];\n\t\t\trange[0] = days_text;\n\t\t\trange[1] = hours;\n\t\t\trange[2] = seconds;\n\t\t\tself_range.value = range\n\t\t\tself_days = days\n\t\t\tself_days_text = days_text\n\t\t\tself_hours = hours\n\t\t\tself_seconds = seconds\n\t\t}\n\t})\n\tconst doChange = () => {\n\t\tvalue_text.value = getValueText()\n\t\tvar day = self_days[self_value.value[0]];\n\t\tvar hour = self_hours[self_value.value[1]];\n\t\tvar second = self_seconds[self_value.value[2]];\n\t\tvar datetime = '';\n\t\tif (day) {\n\t\t\tdatetime = day + ' ' + hour + ':' + second;\n\t\t}\n\t\tvar timestamp = 0;\n\t\tif (datetime) {\n\t\t\ttimestamp = new Date(datetime.replace(/-/g, '/')).getTime();\n\t\t}\n\n\t\temit('dtPickerChanged', {\n\t\t\tdetail: {\n\t\t\t\tvalue: timestamp\n\t\t\t}\n\t\t})\n\t}\n\tconst doColumnChange = (e) => {\n\t\tvar value = self_value.value;\n\t\tvalue[e.detail.column] = e.detail.value;\n\t\tself_value.value = value\n\t}\n\tconst TIME_FORMAT = (t, fmt) => {\n\t\tconst newDate = new Date();\n\t\tnewDate.setTime(t);\n\t\treturn newDate.VP_FORMAT(fmt);\n\t}\n\tconst timestampChange = (timestamp) => {\n\t\t// 未初始化时不执行\n\t\tif (!self_days) {\n\t\t\treturn;\n\t\t}\n\t\tif (timestamp > 0) {\n\t\t\tvar days = self_days;\n\t\t\tvar days_text = self_days_text;\n\t\t\tvar hours = self_hours;\n\t\t\tvar seconds = self_seconds;\n\t\t}\n\t\tif (timestamp < now) {\n\t\t\ttimestamp = now;\n\t\t}\n\t\tvar date = TIME_FORMAT(timestamp, 'YYYY-MM-dd');\n\t\tvar hour = TIME_FORMAT(timestamp, 'hh');\n\t\tvar minutes = TIME_FORMAT(timestamp, 'mm');\n\t\tvar value = toRaw(self_value.value)\n\t\tfor (var i = 0; i < days.length; i++) {\n\t\t\tif (date == days[i]) {\n\t\t\t\tvalue[0] = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tfor (var i = 0; i < hours.length; i++) {\n\t\t\tif (hour == hours[i]) {\n\t\t\t\tvalue[1] = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t// console.log('VP---D>'+value[1]);\n\t\tfor (var i = 0; i < seconds.length; i++) {\n\t\t\tif (minutes == seconds[i]) {\n\t\t\t\tvalue[2] = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tself_value.value = value\n\t\tvalue_text.value = getValueText()\n\t}\n\tconst getValueText = () => {\n\t\tvar day = self_days_text[self_value.value[0]];\n\t\tvar hour = self_hours[self_value.value[1]];\n\t\tvar second = self_seconds[self_value.value[2]];\n\t\tif (self_days[self_value.value[0]] == '') {\n\t\t\treturn day;\n\t\t} else {\n\t\t\treturn day + ' ' + hour + ':' + second;\n\t\t}\n\t}\n\tconsole.log(props, 'props')\n\twatch(props.timestamp, (nd) => {\n\t\ttimestampChange(nd)\n\t}, { immediate: true })\n</script>\n\n<style>\n\t@import './dtPicker.css';\n</style>","import Component from '/Users/daykalif/Desktop/project/components/dtPicker/dtPicker.vue'\nwx.createComponent(Component)"],"names":["ref","onBeforeMount","toRaw","uni","watch","Component"],"mappings":"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"}